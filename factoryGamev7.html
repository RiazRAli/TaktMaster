<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TaktMaster: Factory Flow Simulator</title>
  <style>
    body {
      margin: 0;
      font-family: 'Press Start 2P', 'Courier New', monospace;
      background: #000;
      color: #00ff00;
    }
    header {
      background: #111;
      color: #00ff00;
      padding: 0.5rem;
      text-align: center;
      border-bottom: 4px double #00ff00;
    }
    #controls, #factory {
      position: relative;
      z-index: 1;
      display: flex;
      justify-content: space-around;
      padding: 1rem;
      flex-wrap: wrap;
      position: relative;
      top: 20px;
    }
    .station {
      background: #111;
      padding: 1rem;
      border: 2px dashed #00ff00;
      border-radius: 5px;
      box-shadow: inset 0 0 10px #00ff00;
      width: 190px;
      height: 460px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      margin: 0.25rem;
      text-align: left;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
    }
    .animation {
      width: 24px;
      height: 24px;
      margin: 0 auto 0.5rem;
      border: 3px solid #3498db;
      border-top: 3px solid transparent;
      border-radius: 50%;
      display: none;
    }
    .active .animation {
      display: block;
      animation: spin 1s linear infinite;
    }
    .paused .animation {
      animation-play-state: paused;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes flash {
      0% { opacity: 1; }
      100% { opacity: 0.4; }
    }
    button {
      all: unset;
      background-color: #000;
      border: 3px double white;
      border-color: white green;
      color: #00ff00;
      padding: 0.3rem 0.5rem;
      cursor: pointer;
      margin: 0.2rem;
      font-family: 'Press Start 2P', 'Courier New', monospace;
      text-align: center;
      display: inline-block;
      min-width: auto;
      box-sizing: border-box;
      font-size: 0.9rem;
      text-shadow: 1px 1px 0 #000;
      box-shadow: 0 0 6px #00ff00, inset 0 0 3px #000;
      transition: all 0.2s ease-in-out;
    }
    button:hover {
      background: #00ff00;
      color: #111;
      border-color: #111;
      box-shadow: 0 0 15px #00ff00 inset, 0 0 8px #00ff00;
    }
    .money-time {
      display: flex;
      justify-content: space-between;
      padding: 0 1rem;
      flex-wrap: wrap;
      gap: 1rem;
    }
    header h1 {
      animation: flicker 1.5s infinite alternate;
    }
    @keyframes flicker {
      0% { text-shadow: 0 0 2px #0f0, 0 0 10px #0f0; }
      100% { text-shadow: 0 0 5px #0f0, 0 0 20px #0f0; }
    }
    .zzz-animation {
      animation: zzzFloat 1.2s ease-in-out infinite alternate;
    }
    @keyframes zzzFloat {
      0% { transform: translateY(0); opacity: 0.7; }
      100% { transform: translateY(-4px); opacity: 1; }
    }
  .gear-animation {
  display: block;
  animation: spin 1.2s linear infinite;
}

.win-message {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.9);
  color: orange;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  font-family: 'Press Start 2P', monospace;
}

.win-message > div {
  background: #111;
  border: 4px double orange;
  padding: 2rem;
  text-align: center;
  box-shadow: 0 0 20px orange;
  max-width: 90%;
}

.win-message button {
  margin-top: 1.5rem;
  padding: 0.5rem 1rem;
  background: black;
  border: 2px solid orange;
  color: orange;
  font-family: 'Press Start 2P', monospace;
  cursor: pointer;
  font-size: 0.9rem;
}
.win-message button:hover {
  background: orange;
  color: black;
}

</style>
</head>
<body>
<header>
  <h1>TaktMaster: Factory Flow Simulator</h1>
  
  <div id="arrivalCountdown" style="position: absolute; right: 20px; top: 100px; font-size: 1.2rem; font-weight: bold; color: red;">
    Next Part Arrives In: <span id="countdown" style="animation: flash 1s infinite alternate; color: red;">0</span><span style="color: red;">s</span>
  </div>
  <div style="display: flex; align-items: center;">
    <div style="writing-mode: vertical-rl; transform: rotate(180deg); font-size: 0.6rem; color: #00ff00; line-height: 1;">Takt Time (s)</div>
    <div style="display: flex; flex-direction: column; align-items: flex-start;">
      <canvas id="taktChart" width="600" height="100" style="background: #111; border: 2px solid #00ff00; margin: 1rem 0 0 0; display: block;"></canvas>
      <div style="font-size: 0.6rem; color: #00ff00; margin-left: 3.2rem;">Time ‚Üí</div>
    </div>
  </div>
  
</div>
      
    
  </div>
  <div class="money-time">
  <div>üí∞ Money: $<span id="money">1000</span></div>
  <div>‚è±Ô∏è Time: <span id="timer">0</span>s</div>
  <div>üéØ Takt Time Goal: <span id="taktTime" style="color: yellow;"></span></div>
  <div>üì¶ Total Produced: <span id="totalProduced">0</span> units</div>
  <div>üí∏ Worker Overhead: $<span id="workerCost">0</span>/min</div>
</div>
  
</div>
</div>
</div>
  </div>
</header>
<section id="controls">
  <button id="togglePlayBtn" onclick="togglePlay()">‚ñ∂Ô∏è Play</button>
  <button onclick="toggleSpeed()" id="speedBtn">‚è© Speed: 1x</button>
  <button onclick="resetGame()">üîÑ Reset</button>
  <div style="position: relative; display: flex; align-items: center; gap: 0.5rem; margin-left: 1rem;">
    <label for="variabilitySlider" style="margin: 0;">Variability:</label>
    <input id="variabilitySlider" type="range" min="0" max="2" step="0.1" value="0" style="accent-color: green;">
    <span id="variabilityValue">0</span>
    <div id="tooltip" style="position: absolute; left: 50%; transform: translateX(-50%); bottom: 30px; font-size: 0.9rem; color: white; background: #333; padding: 0.2rem 0.5rem; border-radius: 5px; visibility: hidden;">0</div>
  </div>
  
</section>
<section id="factory"></section>
<div id="transports" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;"></div>
<audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<script>
let money = 1000;
let time = 0;
let totalProduced = 0;
let lastProductTime = 0;
let currentTaktTime = 0;
let completionTimestamps = [];
let taktTimeGoal = 0;
let playing = false;
let timerInterval;
let speed = 1000;
let variability = 0;
let nextArrival = 0;
let taktTimeHistory = [];
let winTimer = 0;
let hasBeenInLoss = false;
let gameWon = false;


function randWorkerCost() {
  // Triangular distribution: min=200, mode=550, max=800
  const u = Math.random();
  const min = 200, mode = 550, max = 800;
  if (u < (mode - min) / (max - min)) {
    return Math.round((min + Math.sqrt(u * (max - min) * (mode - min))) / 10) * 10;
  } else {
    return Math.round((max - Math.sqrt((1 - u) * (max - min) * (max - mode))) / 10) * 10;
  }
}

const stations = [
  { name: 'Cutting', baseTime: randCycle(), workerCost: randWorkerCost(), workers: 1, maxWorkers: 3, upgradeCost: 500, queue: [], processing: [], productivity: 1.0 },
  { name: 'Assembly', baseTime: randCycle(), workerCost: randWorkerCost(), workers: 1, maxWorkers: 4, upgradeCost: 1000, queue: [], processing: [], productivity: 1.0 },
  { name: 'Inspection', baseTime: randCycle(), workerCost: randWorkerCost(), workers: 1, maxWorkers: 2, upgradeCost: 300, queue: [], processing: [], productivity: 1.0 },
  { name: 'Packing', baseTime: randCycle(), workerCost: randWorkerCost(), workers: 1, maxWorkers: 3, upgradeCost: 700, queue: [], processing: [], productivity: 1.0 }
];

function randCycle() {
  return Math.floor(Math.random() * 13 + 8); // 8 to 20 seconds
}

function randArrivalInterval() {
  const minCycle = Math.min(...stations.map(s => s.baseTime));
  const variation = Math.random() * 2; // between 0 and 2
  return time - Math.max(1, Math.floor(minCycle - variation));
}




function updateUI() {
  const productivityLevels = [0.25, 0.5, 0.75, 1.0];
  let totalWorkerCost = stations.reduce((sum, s) => sum + s.workers * 45, 0);
  drawTaktChart();
  document.getElementById("countdown").innerText = Math.max(0, nextArrival - time);
  const moneyElem = document.getElementById("money");
  moneyElem.innerText = Math.round(money);
  moneyElem.style.color = money < 0 ? 'red' : '#00ff00';
  document.getElementById("timer").innerText = time < 60 ? `${time}` : `${Math.floor(time / 60)}m ${time % 60}s`;
  document.getElementById("taktTime").innerHTML = `<span style='color: yellow;'>${taktTimeGoal}</span> <span style='color: #00ff00;'>| Current: ${currentTaktTime}s</span>`;
  document.getElementById("totalProduced").innerText = totalProduced;
  document.getElementById("workerCost").innerText = totalWorkerCost;

  const factory = document.getElementById("factory");
  factory.innerHTML = '';
  stations.forEach((s, i) => {
    const productivityLabel = Math.round(s.productivity * 100);
    const utilization = s.workers > 0 ? (s.processing.length / s.workers) : 0;
    const barHeight = Math.min(100, Math.floor(utilization * 100));
    let bgColor = "#00ff00";
    if (barHeight === 0) bgColor = "repeating-linear-gradient(45deg, red 0, red 5px, #111 5px, #111 10px)";
    else if (barHeight < 50) bgColor = "orange";
    else if (barHeight < 80) bgColor = "yellow";

    const div = document.createElement("div");
    const active = s.processing.length > 0;
    div.className = 'station' + (active ? ' active' : '') + (!playing ? ' paused' : '');
    div.innerHTML = `
      ${active ? (playing ? '<div class="gear-animation" style="margin-bottom: 0.5rem; font-size: 1.5rem; text-align: center;">‚öôÔ∏è</div>' : '<div style="margin-bottom: 0.5rem; font-weight: bold; color: red;">Processing</div>') : '<div class="zzz-animation" style="margin-bottom: 0.5rem; font-size: 1.5rem; text-align: center;">üí§</div>'}
      <h3 style="margin-bottom: 0.2rem;">${s.name}</h3><p style="margin-top: 0; margin-bottom: 0;">Cycle Time: ${s.baseTime}s</p><p style="margin-top: 0;">Workers: (${s.workers}/${s.maxWorkers})</p>
      <div style='font-size: 1.2rem; margin-bottom: 0.3rem;'>${Array.from({ length: s.workers }, (_, idx) => idx === s.workers - 1 ? `<span title='% Time Working: ${Math.round(s.productivity * 100)}%' style='color:${s.productivity < 1 ? "orange" : "inherit"};'>üë∑</span>` : 'üë∑').join('')}</div>
      <p>Queue: ${s.queue.length} units</p>
      <div style='font-size: 1rem;'>${'üì¶'.repeat(Math.min(10, s.queue.length))}${s.queue.length > 10 ? ' ...' : ''}</div>
      <p>Processing: ${s.processing.length} units</p>
      <button onclick="addWorker(${i})">Add Worker ($${s.workerCost})</button>
      <button onclick="removeWorker(${i})">Lay Off Worker</button>
      <button onclick="upgradeStation(${i})">Upgrade ($${s.upgradeCost})</button>
      <button onclick="toggleProductivity(${i})">% Time Working: ${Math.round(s.productivity * 100)}%</button>
    `;

    const barWrapper = document.createElement('div');
    barWrapper.innerHTML = `
      <div style='margin-top: 10px; margin-left: 10px;'>
        <label style='font-size: 0.7rem;'>% Util.</label>
        <div style='height: 100px; width: 20px; border: 2px solid #00ff00; background: #111; position: relative;'>
          <div style='position: absolute; bottom: 0; left: 0; width: 100%; height: ${barHeight}%; background: ${bgColor};'></div>
        </div>
      </div>
    `;
    const wrapper = document.createElement('div');
    wrapper.style.display = 'flex';
    wrapper.style.alignItems = 'flex-start';
    wrapper.appendChild(div);
    wrapper.appendChild(barWrapper);
    factory.appendChild(wrapper);
  });
}

function drawTaktChart() {
  const canvas = document.getElementById('taktChart');
  if (!canvas || taktTimeHistory.length < 2) return;

  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const maxY = Math.max(taktTimeGoal * 2, ...taktTimeHistory);

  // Draw grid lines
  ctx.strokeStyle = '#007700';
  ctx.lineWidth = 1;
  ctx.beginPath();
  const numGridLines = 5;
  for (let i = 1; i < numGridLines; i++) {
    const y = canvas.height * (i / numGridLines);
    ctx.moveTo(0, y);
    ctx.lineTo(canvas.width, y);
  }
  for (let i = 1; i < 6; i++) {
    const x = canvas.width * (i / 6);
    ctx.moveTo(x, 0);
    ctx.lineTo(x, canvas.height);
  }
  ctx.stroke();

  // Draw baseline
  ctx.strokeStyle = '#004400';
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(0, canvas.height - 1);
  ctx.lineTo(canvas.width, canvas.height - 1);
  ctx.stroke();

  // Draw Y-axis tick labels
  ctx.fillStyle = '#00ff00';
  ctx.font = '10px Courier New';
  ctx.textAlign = 'right';
  ctx.textBaseline = 'middle';
  for (let i = 0; i <= numGridLines; i++) {
    const y = canvas.height * (i / numGridLines);
    const value = (maxY * (1 - i / numGridLines)).toFixed(0);
    ctx.fillText(value, canvas.width - 4, y);
  }

  // Draw X-axis tick labels
  ctx.textAlign = 'center';
  ctx.textBaseline = 'top';
  for (let i = 1; i <= 6; i++) {
    const x = canvas.width * (i / 6);
    ctx.fillText((i * 10).toString(), x, canvas.height - 10);
  }

  ctx.strokeStyle = '#00ff00';
  ctx.beginPath();
  taktTimeHistory.forEach((val, idx) => {
    const x = (idx / 60) * canvas.width;
    const y = canvas.height - (val / maxY) * canvas.height;
    if (idx === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  });
  ctx.stroke();

  if (taktTimeGoal > 0) {
    ctx.strokeStyle = '#ffff00';
    const goalY = canvas.height - (taktTimeGoal / maxY) * canvas.height;
    ctx.beginPath();
    ctx.moveTo(0, goalY);
    ctx.lineTo(canvas.width, goalY);
    ctx.stroke();
  }
}

function addWorker(index) {
  const cost = stations[index].workerCost;
  if (money >= cost && stations[index].workers < stations[index].maxWorkers) {
    money -= cost;
    stations[index].workers++;
    updateUI();
  }
}

function removeWorker(index) {
  if (stations[index].workers > 0) {
    stations[index].workers--;
    updateUI();
  }
}

function upgradeStation(index) {
  const s = stations[index];
  if (money >= s.upgradeCost) {
    money -= s.upgradeCost;
    s.maxWorkers++;
    s.upgradeCost = Math.floor(s.upgradeCost * 1.5);
    updateUI();
  }
}

function togglePlay() {
  if (variability === 0) {
    const slider = document.getElementById('variabilitySlider');
    variability = parseFloat(slider.value);
    slider.disabled = true;
  }
  if (taktTimeGoal === 0) {
    const minCycle = Math.min(...stations.map(s => s.baseTime));
    taktTimeGoal = Math.floor(minCycle * 1.3 + 3); // includes transport buffer
    }
  playing = !playing;
  const btn = document.getElementById("togglePlayBtn");
  if (playing) {
    btn.innerText = "‚è∏Ô∏è Pause";
    nextArrival = randArrivalInterval();
    timerInterval = setInterval(advanceTime, speed);
  } else {
    btn.innerText = "‚ñ∂Ô∏è Play";
    clearInterval(timerInterval);
  }
}

function toggleSpeed() {
  speed = (speed === 1000) ? 333 : 1000;
  document.getElementById("speedBtn").innerText = speed === 1000 ? "‚è© Speed: 1x" : "‚è© Speed: 3x";
  if (playing) {
    clearInterval(timerInterval);
    timerInterval = setInterval(advanceTime, speed);
  }
}

function advanceTime() {
  // Subtract $80 per worker per minute (i.e., $1.33 per second)
  let totalWorkers = stations.reduce((sum, s) => sum + s.workers, 0);
  money -= +(totalWorkers * 45 / 60).toFixed(2);
  time++;
  if (time >= nextArrival) {
  stations[0].queue.push({ remaining: stations[0].baseTime + (Math.random() - 0.5) * 2 * variability });

  const minCycle = Math.min(...stations.map(s => s.baseTime));
  const variation = Math.random() * 2;
  nextArrival = Math.max(time + 1, time + Math.floor(minCycle - variation)); // ensures nextArrival > current time
}

  for (let i = 0; i < stations.length; i++) {
    const station = stations[i];
    for (let j = station.processing.length - 1; j >= 0; j--) {
      station.processing[j].remaining--;
      if (station.processing[j].remaining <= 0) {
        station.processing.splice(j, 1);
        if (i === stations.length - 1) {
          completionTimestamps.push(time);
          completionTimestamps = completionTimestamps.filter(t => time - t <= 60);
          let weights = completionTimestamps.map(t => 1 - ((time - t) / 60));
          weights = weights.filter(w => w > 0);
          let weightedSum = weights.reduce((sum, w) => sum + w, 0);
          const taktValue = weightedSum > 0 ? +(60 / weightedSum).toFixed(1) : NaN;
          if (!isNaN(taktValue) && isFinite(taktValue)) {
            currentTaktTime = taktValue;
            taktTimeHistory.push(taktValue);
          }
          if (taktTimeHistory.length > 60) taktTimeHistory.shift();
          lastProductTime = time;
          money += 100;
          totalProduced++;
        } else {
          // Animate transport between stations
const factoryChildren = document.getElementById('factory').children;
const transports = document.getElementById('transports');
const icon = document.createElement('div');
icon.textContent = 'üì¶';
icon.style.position = 'absolute';
icon.style.fontSize = '1.2rem';
icon.style.transition = `transform 3s linear`;

const from = factoryChildren[i].getBoundingClientRect();
const to = factoryChildren[i + 1].getBoundingClientRect();
const containerRect = transports.getBoundingClientRect();

const startX = from.right - containerRect.left;
const startY = from.top - containerRect.top;
const endX = to.left - containerRect.left;
const endY = to.top - containerRect.top;

icon.style.left = `${startX}px`;
icon.style.top = `${startY}px`;
transports.appendChild(icon);

requestAnimationFrame(() => {
  icon.style.transform = `translate(${endX - startX}px, ${endY - startY}px)`;
});

const delay = 3000 + ((Math.random() - 0.5) * 2 * 1000 * variability);
setTimeout(() => {
  icon.remove();
  stations[i + 1].queue.push({ remaining: stations[i + 1].baseTime + (Math.random() - 0.5) * 2 * variability });
  updateUI();
}, delay);
        }
      }
    }
    let fullTime = station.workers > 0 ? station.workers - 1 : 0;
    let effective = fullTime + (station.workers > 0 ? (station.productivity || 1) : 0);
    let capacity = Math.floor(effective);
    while (station.processing.length < capacity && station.queue.length > 0) {
      station.processing.push(station.queue.shift());
    }
  }
  // --- WIN CONDITION CHECK ---
if (!gameWon) {
  const inRange = Math.abs(currentTaktTime - taktTimeGoal) <= 1.6;
  const notBroke = money >= 0;

  if (inRange && notBroke) {
    winTimer++;
  } else {
    winTimer = 0; // reset if the condition breaks at any second
  }

  if (winTimer >= 60) {
    gameWon = true;
    clearInterval(timerInterval);
    showWinMessage();
  }
}
  updateUI();
}

function resetGame() {
  const slider = document.getElementById('variabilitySlider');
  slider.disabled = false;
  variability = parseFloat(slider.value);
  clearInterval(timerInterval);
  money = 1000;
  time = 0;
  totalProduced = 0;
  playing = false;
  document.getElementById("togglePlayBtn").innerText = "‚ñ∂Ô∏è Play";
  document.getElementById("speedBtn").innerText = "‚è© Speed: 1x";
  speed = 1000;
  stations.forEach(station => {
    station.workerCost = randWorkerCost();
    station.baseTime = randCycle();
    station.workers = 1;
    station.queue = [];
    station.processing = [];
    station.maxWorkers = station.name === 'Assembly' ? 4 : (station.name === 'Inspection' ? 2 : 3);
    station.upgradeCost = station.name === 'Cutting' ? 500 : station.name === 'Assembly' ? 1000 : station.name === 'Inspection' ? 300 : 700;
  });
  taktTimeGoal = 0;
  taktTimeHistory = [];
  completionTimestamps = [];
  nextArrival = randArrivalInterval();
  checkWinCondition();
  updateUI();
}

function showWinMessage() {
  const message = document.createElement('div');
  message.className = 'win-message';
  message.innerHTML = `
    <div>
      <h2>üéâ CONGRATULATIONS!!! üéâ</h2>
      <p style="font-size: 0.6rem; margin-top: -1rem; margin-bottom: 1rem;">
        You managed to hold the takt time within +/- 1.6 seconds of the goal while having positive income
      </p>
      <p>You maintained takt for 60s without going broke!</p>
      <p>Total Produced: ${totalProduced} units</p>
      <p>Total Time: ${Math.floor(time / 60)}m ${time % 60}s</p>
      <p>Final Money: $${Math.round(money)}</p>
      <button onclick="dismissWinMessage(this)">üîÅ Play Again</button>
    </div>
  `;
  document.body.appendChild(message);
}


function dismissWinMessage(button) {
  const message = button.closest('.win-message');
  if (message) message.remove();
  resetGame();
}

function toggleProductivity(index) {
  const levels = [0.25, 0.5, 0.75, 1.0];
  const current = stations[index].productivity;
  const nextIndex = (levels.indexOf(current) + 1) % levels.length;
  stations[index].productivity = levels[nextIndex];
  updateUI();
}

document.addEventListener('DOMContentLoaded', () => {
  const sound = document.getElementById('clickSound');
  document.querySelectorAll('button').forEach(btn => {
    btn.addEventListener('click', () => {
      sound.currentTime = 0;
      sound.play();
    });
  });

  updateUI();
});

const slider = document.getElementById("variabilitySlider");
const tooltip = document.getElementById("tooltip");
const variabilityValue = document.getElementById("variabilityValue");

// Set tooltip content and styling once
tooltip.innerText = "Increase/Decrease difficulty by introducing variation. The slider is disabled after <START> is pressed";
tooltip.style.fontSize = "0.55rem";
tooltip.style.maxWidth = "250px";
tooltip.style.textAlign = "center";
tooltip.style.pointerEvents = "none";

// Show tooltip on hover
slider.addEventListener("mouseenter", function () {
  if (!slider.disabled) tooltip.style.visibility = "visible";
});

slider.addEventListener("mousemove", function () {
  const percent = (slider.value - slider.min) / (slider.max - slider.min);
  tooltip.style.left = `${percent * 100}%`;
});

slider.addEventListener("mouseleave", function () {
  tooltip.style.visibility = "hidden";
});

// Update value display
slider.addEventListener("input", function () {
  variabilityValue.innerText = slider.value;
});

function checkWinCondition() {
  const inRange = Math.abs(currentTaktTime - taktTimeGoal) <= 1.6;
  const notBroke = money >= 0;

  if (typeof checkWinCondition.missCounter === 'undefined') {
    checkWinCondition.missCounter = 0;
  }

  if (inRange && notBroke) {
    winTimer++;
    checkWinCondition.missCounter = 0;
  } else {
    checkWinCondition.missCounter++;
    if (checkWinCondition.missCounter > 2) {
      winTimer = 0;
    }
  }

  if (winTimer >= 60) {
    gameWon = true;
    clearInterval(timerInterval);
    showWinMessage();
  }
}

// Cheat code: Ctrl + Alt + W to trigger win condition manually
window.addEventListener('keydown', function(e) {
  if (e.ctrlKey && e.altKey && e.key === 'w') {
    gameWon = true;
    clearInterval(timerInterval);
    showWinMessage();
  }
});

</script>
</body>
</html>


